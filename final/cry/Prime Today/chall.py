from secret import a,b,p,flag
from hashlib import sha512
from pwn import xor
from Crypto.Util.number import isPrime

assert p == a**21 + 21*b**21 and isPrime(p) and a > 0 and b > 0
print(p)
print(xor(flag,sha512(str(a^b).encode()).digest()).hex())

# 101568306509304140087661600401918290211149509460665065446109040015848324660353091925935805021485200653744093171705936370731198499334111466321386723775235105411545029807690513629273006764975261384154858394867557497866369069072648122712534052645524846852324486438951789218490861481579861264264137490761774294577877612788826200065603395743534086135980177153364978306980314086463961856643362041559078958023945662518201116648199403431827569623613447068004800911566022660482779875160868292020115322358693616037349816519190121793573591965298917095263006524201885115749594524499343126793449061113501443798485262875912681737433936842328851211247666440013690774758211833783996551507531235561324118206612933529940339627109523736111211025347705851616031912342068742328133142189327286012297481322968108212652133036851
# dd3b8334414f998ec3ab9dd1222da34a96450afb1e8a68c5219f6d8aa838e6d0f0d975cd9926accfacf07576065027aea9c47f6f6c8b784233d198196422682dc13b882a5b1fc2d0c7